---
import ThemeIcon from "@components/ThemeIcon.astro";

interface NavItem {
  label: string;
  href: string;
}

interface Props {
  items: NavItem[];
}

const { items } = Astro.props as Props;
---

<nav
  id="navbar"
  class="fixed top-4 left-1/2 transform -translate-x-1/2
  bg-background border-4 border-black
  shadow-[8px_8px_0_0_rgba(0,0,0,1)]
  px-6 py-3 rounded-lg
  transition-all duration-300 ease-in-out
  z-50
  flex justify-between items-center
  w-[calc(100%-2rem)] max-w-4xl">
  <ul class="flex space-x-6">
    {
      items.map((item) => (
        <li>
          <a
            class="nav-link"
            href={item.href}>
            {item.label}
          </a>
        </li>
      ))
    }
  </ul>
  <ThemeIcon />
</nav>

<style>
  .nav-link {
    @apply font-bold text-lg text-foreground relative transition-all duration-300;
  }

  .nav-link::after {
    content: "";
    @apply absolute left-0 -bottom-1 w-0 h-1 bg-primary transition-all duration-300;
  }

  .nav-link:hover::after,
  .nav-link.active::after {
    @apply w-full;
  }

  .nav-link.active {
    @apply text-foreground;
  }
</style>

<script is:inline>
  let prevScrollPos = window.scrollY;
  const navbar = document.getElementById("navbar");
  const navLinks = document.querySelectorAll(".nav-link");
  const currentPath = window.location.pathname;

  window.onscroll = () => {
    const currentScrollPos = window.scrollY;

    if (navbar) {
      if (prevScrollPos > currentScrollPos) {
        navbar.style.transform = "translate(-50%, 0)";
        navbar.style.opacity = "1";
      } else {
        navbar.style.transform = "translate(-50%, -150%)";
        navbar.style.opacity = "0";
      }
    }

    prevScrollPos = currentScrollPos;
  };

  navLinks.forEach((link) => {
    if (link.getAttribute("href") === currentPath) {
      link.classList.add("active");
    }
  });
</script>
